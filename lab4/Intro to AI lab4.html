<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Intro to AI lab4 - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @charset "UTF-8";@import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{height:40px;padding:10px 4px;border-top-left-radius:0;border-bottom-left-radius:0}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:20px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-published-note{color:#337ab7}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true"><h1 id="Intro-to-AI-lab-4---Random-Forest-Implementation-and-Discussion" data-id="Intro-to-AI-lab-4---Random-Forest-Implementation-and-Discussion"><a class="anchor hidden-xs" href="#Intro-to-AI-lab-4---Random-Forest-Implementation-and-Discussion" title="Intro-to-AI-lab-4---Random-Forest-Implementation-and-Discussion"><span class="octicon octicon-link"></span></a><span>Intro to AI lab 4 - Random Forest, Implementation and Discussion</span></h1><hr><h2 id="Information" data-id="Information"><a class="anchor hidden-xs" href="#Information" title="Information"><span class="octicon octicon-link"></span></a><span>Information</span></h2><ul>
<li><span>Author: Yan-Tong Lin</span></li>
<li><span>0712238@NCTU, National Chiao Tung University, Taiwan</span></li>
<li><span>E-mail</span>
<ul>
<li><a href="mailto:0312fs3@gmail.com" target="_blank" rel="noopener"><span>0312fs3@gmail.com</span></a></li>
</ul>
</li>
<li><span>I did the random forest python implemtation all by my self.</span></li>
<li><span>The report statements are developed by my self. (not from wiki or something else)</span></li>
</ul><hr><h2 id="Task-description" data-id="Task-description"><a class="anchor hidden-xs" href="#Task-description" title="Task-description"><span class="octicon octicon-link"></span></a><span>Task description</span></h2><ul>
<li><span>Implementation of random forest from scatch.</span></li>
<li><span>Discussion on topics of one’s choice.</span></li>
<li><span>The dataset</span>
<ul>
<li><span>I developped my code of random forest on the dataset “iris”</span></li>
<li><span>After realizing the dataset is too trivial for a random forest, “Optical Recognition of Handwritten Digits” was chosen to be my experiment playground</span></li>
<li><span>the description of the datasets can be found in reference [2]</span></li>
</ul>
</li>
</ul><hr><h2 id="Description-of-random-forest" data-id="Description-of-random-forest"><a class="anchor hidden-xs" href="#Description-of-random-forest" title="Description-of-random-forest"><span class="octicon octicon-link"></span></a><span>Description of random forest</span></h2><h3 id="Decision-Tree" data-id="Decision-Tree"><a class="anchor hidden-xs" href="#Decision-Tree" title="Decision-Tree"><span class="octicon octicon-link"></span></a><span>Decision Tree</span></h3><p><span>A decision tree is a machine learning model trained on a fixed set of data.</span><br>
<span>It </span><strong><span>recursively devides the given training data</span></strong><span> to groups by attributes determined by </span><strong><span>a measurement of purity</span></strong><span>, and predict coming instances by the devisions trained.</span><br>
<span>Decision trees are </span><strong><span>strong models</span></strong><span> since they can do arbitrarily well on a giving trainning set.</span></p><h4 id="CART-and-Gini’s-impurity" data-id="CART-and-Gini’s-impurity"><a class="anchor hidden-xs" href="#CART-and-Gini’s-impurity" title="CART-and-Gini’s-impurity"><span class="octicon octicon-link"></span></a><span>CART and Gini’s impurity</span></h4><p><span>In the case of CART, the tree devides data to </span><strong><span>2</span></strong><span> groups at once, and the criterion of (im)purity is </span><strong><span>Gini’s index</span></strong><span>.</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-100-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mo>=</mo><mn>1</mn><mo>&amp;#x2212;</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>c</mi></munderover><msubsup><mi>p</mi><mi>i</mi><mn>2</mn></msubsup></math>" role="presentation" style="font-size: 118%; position: relative;"><span id="MJXc-Node-1067" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1068" class="mjx-mrow"><span id="MJXc-Node-1069" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">G</span></span><span id="MJXc-Node-1070" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1071" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1072" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1073" class="mjx-munderover MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1074" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span><span class="mjx-stack" style="vertical-align: -0.31em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.422em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1080" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1075" class="mjx-texatom" style=""><span id="MJXc-Node-1076" class="mjx-mrow"><span id="MJXc-Node-1077" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1078" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1079" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span></span></span></span><span id="MJXc-Node-1081" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-1082" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1084" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1083" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo>=</mo><mn>1</mn><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>c</mi></munderover><msubsup><mi>p</mi><mi>i</mi><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-100">G = 1-\sum_{i=0}^c p_i^2</script></span><span> or </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-101-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>c</mi></munderover><msub><mi>p</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 118%; position: relative;"><span id="MJXc-Node-1085" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1086" class="mjx-mrow"><span id="MJXc-Node-1087" class="mjx-munderover"><span class="mjx-base"><span id="MJXc-Node-1088" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span><span class="mjx-stack" style="vertical-align: -0.31em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.422em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1094" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1089" class="mjx-texatom" style=""><span id="MJXc-Node-1090" class="mjx-mrow"><span id="MJXc-Node-1091" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1092" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1093" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span></span></span></span><span id="MJXc-Node-1095" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-1096" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1097" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1098" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1099" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1100" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1101" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1102" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1103" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1104" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>c</mi></munderover><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-101">\sum_{i=0}^c p_i(1-p_i)</script></span></p><h3 id="Random-Forest" data-id="Random-Forest"><a class="anchor hidden-xs" href="#Random-Forest" title="Random-Forest"><span class="octicon octicon-link"></span></a><span>Random Forest</span></h3><p><strong><span>Bagging</span></strong><span>(bootstrap aggregating) is a technique/meta-algorithm in machine learning aiming to </span><strong><span>decrease variance</span></strong><span> and increase stability.</span><br>
<span>The core idea is that </span><strong><span>strong models</span></strong><span> tend to overfit noises; However, multiple strong models tend to agree on signals instead of noises.</span><br>
<span>The random forest algorithm is a classical example of bagging model, and its base models are decision trees.</span><br>
<span>Please refer to the original paper[1] by Breiman for more details.</span></p><h4 id="Tree-bagging" data-id="Tree-bagging"><a class="anchor hidden-xs" href="#Tree-bagging" title="Tree-bagging"><span class="octicon octicon-link"></span></a><span>Tree bagging</span></h4><p><span>For each </span><strong><span>tree</span></strong><span>, bootstrap(sample with replacement) </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-102-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>o</mi><mi>p</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub></math>" role="presentation" style="font-size: 118%; position: relative;"><span id="MJXc-Node-1105" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1106" class="mjx-mrow"><span id="MJXc-Node-1107" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1108" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1109" class="mjx-texatom" style=""><span id="MJXc-Node-1110" class="mjx-mrow"><span id="MJXc-Node-1111" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span><span id="MJXc-Node-1112" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">o</span></span><span id="MJXc-Node-1113" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span><span id="MJXc-Node-1114" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">u</span></span><span id="MJXc-Node-1115" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span><span id="MJXc-Node-1116" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-1117" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-1118" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1119" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">o</span></span><span id="MJXc-Node-1120" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>o</mi><mi>p</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-102">n_{population}</script></span><span> data from the original dataset.</span></p><h4 id="Feature-bagging" data-id="Feature-bagging"><a class="anchor hidden-xs" href="#Feature-bagging" title="Feature-bagging"><span class="octicon octicon-link"></span></a><span>Feature bagging</span></h4><p><span>Sample (without replacement) </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-103-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="font-size: 118%; position: relative;"><span id="MJXc-Node-1121" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1122" class="mjx-mrow"><span id="MJXc-Node-1123" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-103">k</script></span><span> of </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-104-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi></math>" role="presentation" style="font-size: 118%; position: relative;"><span id="MJXc-Node-1124" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1125" class="mjx-mrow"><span id="MJXc-Node-1126" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.003em;">d</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-104">d</script></span><span> attributes of the original data for each </span><strong><span>split</span></strong><span>.</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-105-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="font-size: 118%; position: relative;"><span id="MJXc-Node-1127" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1128" class="mjx-mrow"><span id="MJXc-Node-1129" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">k</script></span><span> is suggested to be </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-106-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msqrt><mi>d</mi></msqrt></math>" role="presentation" style="font-size: 118%; position: relative;"><span id="MJXc-Node-1130" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1131" class="mjx-mrow"><span id="MJXc-Node-1132" class="mjx-msqrt"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">√</span></span><span class="mjx-box" style="padding-top: 0.111em; border-top: 1.4px solid;"><span id="MJXc-Node-1133" class="mjx-mrow"><span id="MJXc-Node-1134" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.003em;">d</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><mi>d</mi></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-106">\sqrt{d}</script></span><span> for classification tasks by the original paper[1].</span></p><hr><h2 id="Implementation" data-id="Implementation"><a class="anchor hidden-xs" href="#Implementation" title="Implementation"><span class="octicon octicon-link"></span></a><span>Implementation</span></h2><p><span>This is a brief decription of my implementation of Node, CART and RandomForest classes.</span><br>
<span>For more details, refer to the appendix code.</span></p><p><span>Generally, the main functions of a decision tree is in the “split” method of the “Node” class.</span><br>
<span>Other classes are basically wrappers.</span></p><h3 id="Node" data-id="Node"><a class="anchor hidden-xs" href="#Node" title="Node"><span class="octicon octicon-link"></span></a><span>Node</span></h3><ul>
<li><span>Attributes</span>
<ul>
<li><span>c, the children array, c[0] = left, c[1] = right</span></li>
<li><span>sf, split feature</span></li>
<li><span>th, threshold</span></li>
<li><span>maj, majarity of the training data in the subtree rooted at this node</span></li>
<li><span>depth, depth of the node(for cutting)</span></li>
<li><span>leaf, if this node is a leaf node</span></li>
</ul>
</li>
<li><span>Supported methods</span>
<ul>
<li><span>split(data, options…)</span></li>
</ul>
</li>
</ul><h3 id="Cart" data-id="Cart"><a class="anchor hidden-xs" href="#Cart" title="Cart"><span class="octicon octicon-link"></span></a><span>Cart</span></h3><ul>
<li><span>Attributes</span>
<ul>
<li><span>rt, the root node of the decision tree</span></li>
</ul>
</li>
<li><span>Supported methods</span>
<ul>
<li><span>train(dataset, options…)</span></li>
<li><span>predict(vector)</span></li>
<li><span>calc_ac(dataset)</span></li>
</ul>
</li>
</ul><h3 id="Randon-Forest" data-id="Randon-Forest"><a class="anchor hidden-xs" href="#Randon-Forest" title="Randon-Forest"><span class="octicon octicon-link"></span></a><span>Randon Forest</span></h3><ul>
<li><span>Attributes(sk learn style)</span>
<ul>
<li><span>dtrees, the list of decision trees of the forest</span></li>
<li><span>n_estimators, number of estimators(decision trees)</span></li>
<li><span>criterion, “Gini” or “entropy”</span></li>
<li><span>max_features, “sqrt” or “log” or “one”</span></li>
<li><span>max_depth, for depth cut</span></li>
<li><span>min_impurity_decrease, for min impurity cut</span></li>
<li><span>bootstrap, sample data or not</span></li>
<li><span>max_samples, number of sampled data for each tree(ratio or integer or None)</span></li>
</ul>
</li>
<li><span>Supported methods</span>
<ul>
<li><span>train(dataset, options…)</span></li>
<li><span>predict(vector)</span></li>
<li><span>calc_ac(dataset)</span></li>
</ul>
</li>
</ul><hr><h2 id="Experimental-Results-and-Discussion" data-id="Experimental-Results-and-Discussion"><a class="anchor hidden-xs" href="#Experimental-Results-and-Discussion" title="Experimental-Results-and-Discussion"><span class="octicon octicon-link"></span></a><span>Experimental Results and Discussion</span></h2><h3 id="Setting-of-experients" data-id="Setting-of-experients"><a class="anchor hidden-xs" href="#Setting-of-experients" title="Setting-of-experients"><span class="octicon octicon-link"></span></a><span>Setting of experients</span></h3><ul>
<li><span>we change the param that we want to discuss, and remainings are set to defaults</span></li>
<li><span>the default values for hyper params</span>
<ul>
<li><span>n_estimators = 10</span></li>
<li><span>criterion = “Gini”</span></li>
<li><span>max_features = “sqrt”</span></li>
<li><span>cuts = No cut</span></li>
<li><span>bootstrap = True</span></li>
<li><span>max_examples = 1.0</span></li>
</ul>
</li>
<li><span>An experiment on a setting of a value of discussing param is conducted 10 times</span></li>
<li><span>the following graph shows the confusion matrix of the default setting</span></li>
</ul><p><img src="https://i.imgur.com/zIZPuid.png" alt=""><br>
<img src="https://i.imgur.com/DFetcJz.png" alt=""></p><h3 id="Choice-of-Order-of-Experiments" data-id="Choice-of-Order-of-Experiments"><a class="anchor hidden-xs" href="#Choice-of-Order-of-Experiments" title="Choice-of-Order-of-Experiments"><span class="octicon octicon-link"></span></a><span>Choice of Order of Experiments</span></h3><ul>
<li><span>Trainning/Validation Set Size</span>
<ul>
<li><span>choose a better measurement</span></li>
</ul>
</li>
<li><span>Population first</span>
<ul>
<li><span>to choose a suitable population for evaluation</span></li>
</ul>
</li>
<li><span>Others</span></li>
</ul><h3 id="Training-Set-Size" data-id="Training-Set-Size"><a class="anchor hidden-xs" href="#Training-Set-Size" title="Training-Set-Size"><span class="octicon octicon-link"></span></a><span>Training Set Size</span></h3><p><img src="https://i.imgur.com/TImMmJw.png" alt=""></p><ul>
<li><span>F1 score grows as training set ratio grows bigger</span></li>
<li><span>It is not a surprise since more training data means we have more infromation about the function we want to learn.</span></li>
<li><span>And less validation data means it is less probable that the model get caught on an instance that it does not decribe well.</span></li>
<li><span>Note that in the task 10%(562) of data is enough for achieving 90% F1 score</span></li>
</ul><h3 id="Number-of-trees-and-F1-score" data-id="Number-of-trees-and-F1-score"><a class="anchor hidden-xs" href="#Number-of-trees-and-F1-score" title="Number-of-trees-and-F1-score"><span class="octicon octicon-link"></span></a><span>Number of trees and F1 score</span></h3><p><img src="https://i.imgur.com/dDikmNQ.png" alt=""></p><ul>
<li><span>F1 score grows as training set ratio grows bigger</span></li>
<li><span>This is not surprising either since aggregating more strong models means more powerful!</span></li>
<li><span>An advantage of random forest is that it does not overfit for using more trees to vote</span></li>
</ul><h3 id="Criterion-for-spliting" data-id="Criterion-for-spliting"><a class="anchor hidden-xs" href="#Criterion-for-spliting" title="Criterion-for-spliting"><span class="octicon octicon-link"></span></a><span>Criterion for spliting</span></h3><p><img src="https://i.imgur.com/rNIalIT.png" alt=""></p><ul>
<li><span>redo the last experiment with both criterion</span></li>
<li><span>the two criterions(Gini’s impurity and Shannon’s entropy) act almost identical</span></li>
<li><span>But Gini’s impurity should has a better time constant, maybe this is why CART choose Gini’s instead of Shannon’s.</span></li>
</ul><h3 id="Early-Cut---Depth-of-TreesSplit-Constraint-on-number-of-dataMin-Impurity-Gain" data-id="Early-Cut---Depth-of-TreesSplit-Constraint-on-number-of-dataMin-Impurity-Gain"><a class="anchor hidden-xs" href="#Early-Cut---Depth-of-TreesSplit-Constraint-on-number-of-dataMin-Impurity-Gain" title="Early-Cut---Depth-of-TreesSplit-Constraint-on-number-of-dataMin-Impurity-Gain"><span class="octicon octicon-link"></span></a><span>Early Cut - Depth of Trees/Split Constraint on number of data/Min Impurity Gain</span></h3><p><img src="https://i.imgur.com/UzCKo4h.png" alt=""><br>
<img src="https://i.imgur.com/ubVA1Xt.png" alt=""><br>
<img src="https://i.imgur.com/ZDlFgAs.png" alt=""></p><ul>
<li><span>The test F1 score rises as capacity of a single model grows</span></li>
<li><span>Bagging method works on low bias, high variance model, limiting the capacity of a simgle component is not a good idea.</span></li>
</ul><hr><h2 id="Conclusion-and-Future-investigations" data-id="Conclusion-and-Future-investigations"><a class="anchor hidden-xs" href="#Conclusion-and-Future-investigations" title="Conclusion-and-Future-investigations"><span class="octicon octicon-link"></span></a><span>Conclusion and Future investigations</span></h2><p><span>Random forest is indead a powerful model. Utilizing the bagging meta-algorithm, the model is able to take advantages of the model strength of decision trees while maintaining an acceptable variance. No wonder there are so many tasks on Kaggles that random forest outperforms many other algorithms. Even with neural networks rising in popularity, I think that it will remain a robust and efficient choice for some problems.</span></p><p><span>In this assignment, I found it relatively easy to implement this model considering how powerful it is. And by conducting experiments, I am able to varify the properties of random forest.</span></p><p><span>A future work for my implementation may be optimizing the time and memory usage. Also, an investigation for me to pose is that - is there an “online” version of decision trees?</span></p><p><span>Also, an interesting counterpart to the bagging technique is the “boosting” technique, and gradient-boosted tree is a well-knowned example. I am looking forward to explore the algorithm in the summer vacation, with my ability to self-learn and implement AI algorithms that obtained and strengthened in this class.</span></p><hr><h2 id="Reference" data-id="Reference"><a class="anchor hidden-xs" href="#Reference" title="Reference"><span class="octicon octicon-link"></span></a><span>Reference</span></h2><ul>
<li><span>[1] Breiman, L. Random Forests. Machine Learning 45, 5–32 (2001).</span>
<ul>
<li><span>The original paper of random forest</span></li>
</ul>
</li>
<li><span>[2] Dua, D. and Graff, C. (2019). UCI Machine Learning Repository. Irvine, CA: University of California, School of Information and Computer Science.</span>
<ul>
<li><span>The datasets come from this repository</span></li>
</ul>
</li>
<li><span>[3] Scikit-learn: Machine Learning in Python, Pedregosa et al., JMLR 12, pp. 2825-2830, 2011.</span>
<ul>
<li><span>sk learn tools - for F1 scores, confusion matrices, etc.</span></li>
</ul>
</li>
</ul><hr><h2 id="Appendix-A---Python-Implementation-of-Random-Forest" data-id="Appendix-A---Python-Implementation-of-Random-Forest"><a class="anchor hidden-xs" href="#Appendix-A---Python-Implementation-of-Random-Forest" title="Appendix-A---Python-Implementation-of-Random-Forest"><span class="octicon octicon-link"></span></a><span>Appendix A - Python Implementation of Random Forest</span></h2><h3 id="RandomForestpy" data-id="RandomForestpy"><a class="anchor hidden-xs" href="#RandomForestpy" title="RandomForestpy"><span class="octicon octicon-link"></span></a><a href="http://RandomForest.py" rel="noopener" target="_blank"><span>RandomForest.py</span></a></h3><pre><code class="python3 hljs"><span class="hljs-comment">#!/usr/bin/env python</span>
<span class="hljs-comment"># coding: utf-8</span>
<span class="hljs-comment"># author = 0712238, Yan-Tong Lin</span>

import numpy  as np
import pandas as pd
import random
from collections import defaultdict


<span class="hljs-comment"># # Hyper Params and other</span>

fname = <span class="hljs-string">"./dat/iris.data"</span>
TEST = True
n_feature = <span class="hljs-number">64</span>
n_class = <span class="hljs-number">10</span>
LAB = n_feature 
epsilon = <span class="hljs-number">0</span>.<span class="hljs-number">00000001</span>

<span class="hljs-comment"># # preprocessing</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">load_data</span><span class="hljs-params">(fname, partition=(<span class="hljs-number">8</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)</span></span>):
    <span class="hljs-comment"># read in, df to nparray</span>
    df = pd.read_csv(fname, header=None)
    npd = np.array(df)
    n = npd.shape[<span class="hljs-number">0</span>]
    
    <span class="hljs-comment"># tag to id, id to tag, transform</span>
    tag_map = defaultdict(int)
    tag_to_id = defaultdict(int)
    id_to_tag = defaultdict(int)
    <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-symbol">npd:</span>
        tag_map[d[LAB]] += <span class="hljs-number">1</span>
    
    cnt = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> tag_map.items():
        id_to_tag[cnt] = k
        tag_to_id[k] = cnt
        cnt += <span class="hljs-number">1</span>
        
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n):
        npd[i][LAB] = tag_to_id[npd[i][LAB]]
    <span class="hljs-comment">#print(tag_to_id)</span>
    <span class="hljs-comment">#print(id_to_tag)</span>
    
    <span class="hljs-comment"># shuffle(no when testing)</span>
    np.random.shuffle(npd)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-symbol">TEST:</span>
        np.random.shuffle(npd)
    
    <span class="hljs-comment"># partition</span>
    cut1 = int(n*partition[<span class="hljs-number">0</span>]/sum(partition))
    cut2 = int((n*(partition[<span class="hljs-number">0</span>] + partition[<span class="hljs-number">1</span>])/sum(partition)))
    <span class="hljs-comment"># print(cut1, cut2)</span>
    train_set = npd[<span class="hljs-symbol">:cut1</span>, <span class="hljs-symbol">:</span>]
    valid_set = npd[<span class="hljs-symbol">cut1:</span>cut2, <span class="hljs-symbol">:</span>]
    test_set = npd[<span class="hljs-symbol">cut2:</span>, <span class="hljs-symbol">:</span>]
    
    <span class="hljs-keyword">return</span> train_set, valid_set, test_set, tag_to_id, id_to_tag


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Gini</span><span class="hljs-params">(data, feature_id = -<span class="hljs-number">1</span>, threshold = None)</span></span>:
    n = len(data)
    sigma = <span class="hljs-number">0</span>.<span class="hljs-number">0</span>
    <span class="hljs-comment"># first dimension, lc or rc</span>
    <span class="hljs-comment"># second dimension, map label type to cnt, map[n_class] = total</span>
    group_labels = [defaultdict(int), defaultdict(int)] <span class="hljs-comment"># group 1 stat, group 2 stat</span>
    <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-symbol">data:</span>
        <span class="hljs-keyword">if</span> feature_id == -<span class="hljs-number">1</span>:
            group_labels[<span class="hljs-number">0</span>][d[LAB]] += <span class="hljs-number">1</span>
            group_labels[<span class="hljs-number">0</span>][n_class] += <span class="hljs-number">1</span>
        <span class="hljs-symbol">else:</span>
            group_labels[d[feature_id] &lt; threshold][d[LAB]] += <span class="hljs-number">1</span>
            group_labels[d[feature_id] &lt; threshold][n_class] += <span class="hljs-number">1</span> <span class="hljs-comment">#total</span>
    <span class="hljs-comment">#print(group_labels)</span>
    <span class="hljs-keyword">for</span> g <span class="hljs-keyword">in</span> <span class="hljs-symbol">group_labels:</span>
        w = g[n_class]/n
        cur = <span class="hljs-number">0</span>.<span class="hljs-number">0</span>
        <span class="hljs-keyword">if</span>(g[n_class] == <span class="hljs-number">0</span>):
            continue
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_class):
            p = g[i]/g[n_class]
            cur += p*p
        sigma += w*cur
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> - sigma
    

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span>(): <span class="hljs-comment"># subtree</span></span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(<span class="hljs-keyword">self</span>)</span></span>:
        <span class="hljs-keyword">self</span>.c = [None, None] <span class="hljs-comment"># child, c[0] =&gt; &lt; threshold , c[1]</span>
        <span class="hljs-keyword">self</span>.sf = None <span class="hljs-comment"># split feature</span>
        <span class="hljs-keyword">self</span>.th = None <span class="hljs-comment"># threshold</span>
        <span class="hljs-keyword">self</span>.maj = None <span class="hljs-comment"># majority label in this subtree</span>
        <span class="hljs-keyword">self</span>.depth = None <span class="hljs-comment">#depth</span>
        <span class="hljs-keyword">self</span>.leaf = True
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">split</span><span class="hljs-params">(<span class="hljs-keyword">self</span>, data, criterion=<span class="hljs-string">"gini"</span>, max_features=None, max_depth=None, min_impurity_decrease=None, depth=<span class="hljs-number">0</span>)</span></span>: 
        n = len(data)
        <span class="hljs-keyword">self</span>.depth = depth
        
        <span class="hljs-comment"># deal with min_impurity_decrease</span>
        <span class="hljs-keyword">if</span> min_impurity_decrease == <span class="hljs-symbol">None:</span>
            min_impurity_decrease = epsilon <span class="hljs-comment"># inf small to represent any gain &gt; epsilon is ok</span>
        
        <span class="hljs-comment"># criterion =&gt; func</span>
        <span class="hljs-keyword">if</span> criterion == <span class="hljs-string">"gini"</span>:
            func = Gini
        elif criterion == <span class="hljs-string">"entropy"</span>:
            func = None
        <span class="hljs-symbol">else:</span>
            print(<span class="hljs-string">"not a valid critirien, use Gini's impurity"</span>)
            func = Gini
        
        <span class="hljs-comment"># calc majority</span>
        vote = defaultdict(int)
        <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-symbol">data:</span>
            vote[d[LAB]] += <span class="hljs-number">1</span>
        <span class="hljs-keyword">self</span>.maj = max(vote, key=vote.get)
        
        <span class="hljs-comment"># cut if maxd exceed</span>
        <span class="hljs-keyword">if</span>(max_depth <span class="hljs-keyword">and</span> <span class="hljs-keyword">self</span>.depth &gt;= max_depth):
            print(<span class="hljs-string">"maxd_cut"</span>)
            <span class="hljs-keyword">self</span>.leaf = True
            <span class="hljs-keyword">return</span>
        
        <span class="hljs-comment"># feature_mask (max_feature)</span>
        mask = np.zeros(n_feature)
        <span class="hljs-keyword">if</span> max_features == None :
            n_sample_f = n_feature
        elif max_features == <span class="hljs-string">"sqrt"</span>:
            n_sample_f = int(np.ceil(np.sqrt(n_feature)))
        elif max_features == <span class="hljs-string">"log"</span>:
            n_sample_f = int(np.ceil(np.log2(n_feature)))
        elif max_features == <span class="hljs-string">"one"</span>:
            n_sample_f = <span class="hljs-number">1</span>
        <span class="hljs-symbol">else:</span>
            print(<span class="hljs-string">"Error: No Such Max Feature"</span>)
            assert(False)
        
        <span class="hljs-comment"># random.choices may with repeat</span>
        <span class="hljs-comment"># random.sample without</span>
        sampled_features = random.sample(list(range(n_feature)), k=n_sample_f)
        <span class="hljs-keyword">for</span> sampled_feature <span class="hljs-keyword">in</span> <span class="hljs-symbol">sampled_features:</span>
            mask[sampled_feature] = <span class="hljs-number">1</span>
            
        <span class="hljs-comment"># select feature </span>
        best_gain = <span class="hljs-number">0</span>.<span class="hljs-number">0</span>
        best_branch = (None, None)
        cur_func = func(data)
        <span class="hljs-comment"># cut if impurity is low enough</span>
        <span class="hljs-keyword">if</span>(cur_func &lt; min_impurity_decrease):
            <span class="hljs-comment"># print("min_impuraity cut"), left element</span>
            <span class="hljs-keyword">self</span>.leaf = True
            <span class="hljs-keyword">return</span> 
        
        <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> range(n_feature):
            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">not</span> mask[f]):
                continue
            <span class="hljs-comment">#print(data.shape)</span>
            sort_by_f = data[data[<span class="hljs-symbol">:</span>,f].argsort()]
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n-<span class="hljs-number">1</span>):
                th = (sort_by_f[i+<span class="hljs-number">1</span>][f] + sort_by_f[i][f])/<span class="hljs-number">2</span>
                <span class="hljs-comment">#print(th)</span>
                cur_gain = abs(func(sort_by_f, f, th) - cur_func)
                <span class="hljs-keyword">if</span>(cur_gain &gt; best_gain):
                    best_branch = (f, th)
                    best_gain = cur_gain
        
        <span class="hljs-comment"># cut if not enough gain</span>
        <span class="hljs-keyword">if</span>(best_gain &lt; min_impurity_decrease):
            print(<span class="hljs-string">"min_impuraity_gain cut"</span>)
            <span class="hljs-keyword">self</span>.leaf = True
            <span class="hljs-keyword">return</span> 
        <span class="hljs-symbol">else:</span>
            <span class="hljs-keyword">self</span>.leaf = False
        
        <span class="hljs-comment"># actually split by best</span>
        <span class="hljs-keyword">self</span>.sf = best_branch[<span class="hljs-number">0</span>]
        <span class="hljs-keyword">self</span>.th = best_branch[<span class="hljs-number">1</span>]
        
        c_data = [[], []]
        <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-symbol">data:</span>
            c_data[d[best_branch[<span class="hljs-number">0</span>]] &lt; best_branch[<span class="hljs-number">1</span>]].append(d)
        <span class="hljs-comment"># print(c_data)</span>
        <span class="hljs-keyword">self</span>.c = [None, None]
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">2</span>):
            <span class="hljs-keyword">self</span>.c[i] = Node()
            <span class="hljs-keyword">self</span>.c[i].split(np.array(c_data[i]), criterion, max_features, max_depth, min_impurity_decrease, depth+<span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span>


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CART</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(<span class="hljs-keyword">self</span>)</span></span>:
        <span class="hljs-keyword">self</span>.rt = Node()
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">train</span><span class="hljs-params">(<span class="hljs-keyword">self</span>, dataset, criterion=<span class="hljs-string">"gini"</span>, max_features=None, max_depth=None, min_impurity_decrease=None)</span></span>:
        <span class="hljs-keyword">self</span>.rt.split(dataset, criterion, max_features, max_depth, min_impurity_decrease)
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">predict</span><span class="hljs-params">(<span class="hljs-keyword">self</span>, v)</span></span>:
        cur = <span class="hljs-keyword">self</span>.rt
        <span class="hljs-keyword">while</span>(cur.leaf == False):
            cur = cur.c[v[cur.sf] &lt; cur.th]
        <span class="hljs-keyword">return</span> cur.maj
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calc_ac</span><span class="hljs-params">(<span class="hljs-keyword">self</span>, testd)</span></span>:
        total = <span class="hljs-number">0</span>.<span class="hljs-number">0</span>
        succ = <span class="hljs-number">0</span>.<span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-symbol">testd:</span>
            succ += int(<span class="hljs-keyword">self</span>.predict(d) == d[LAB])
            total += <span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> succ/total

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RandomForest</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(<span class="hljs-keyword">self</span>, n_estimators=<span class="hljs-number">100</span>, criterion=<span class="hljs-string">"gini"</span>, max_features=<span class="hljs-string">"sqrt"</span>, max_depth=None, min_impurity_decrease=None, bootstrap=True, max_samples=None)</span></span>:
        <span class="hljs-keyword">self</span>.n_estimators = n_estimators
        <span class="hljs-keyword">self</span>.criterion = criterion
        <span class="hljs-keyword">self</span>.max_features = max_features
        <span class="hljs-keyword">self</span>.max_depth = max_depth
        <span class="hljs-keyword">self</span>.min_impurity_decrease = min_impurity_decrease
        <span class="hljs-keyword">self</span>.max_samples = max_samples
        <span class="hljs-keyword">self</span>.dtrees = []
        <span class="hljs-keyword">self</span>.bootstrap = bootstrap
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">train</span><span class="hljs-params">(<span class="hljs-keyword">self</span>, data)</span></span>:
        n = data.shape[<span class="hljs-number">0</span>]
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.max_samples == <span class="hljs-symbol">None:</span>
            n_population = n
        elif type(<span class="hljs-keyword">self</span>.max_samples) == <span class="hljs-symbol">float:</span>
            n_population = int(n*<span class="hljs-keyword">self</span>.max_samples)
        elif type(<span class="hljs-keyword">self</span>.max_samples) == <span class="hljs-symbol">int:</span>
            <span class="hljs-keyword">self</span>.n_polulation = <span class="hljs-keyword">self</span>.max_samples
        <span class="hljs-symbol">else:</span>
            print(<span class="hljs-string">"MAX SAMPLE TYPE ERROR"</span>)
            assert(False)
            <span class="hljs-keyword">return</span>
        
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-keyword">self</span>.n_estimators):
            ti = CART()
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.bootstrap == <span class="hljs-symbol">True:</span>
                sampled_ids = np.random.choice(n, n_population, replace=True)
            <span class="hljs-symbol">else:</span>
                sampled_ids = list(range(n))
            bootstrap_data = data[sampled_ids]
            ti.train(bootstrap_data, criterion=<span class="hljs-keyword">self</span>.criterion, max_features=<span class="hljs-keyword">self</span>.max_features, max_depth=<span class="hljs-keyword">self</span>.max_depth, min_impurity_decrease=<span class="hljs-keyword">self</span>.min_impurity_decrease)
            <span class="hljs-keyword">self</span>.dtrees.append(ti)
        <span class="hljs-keyword">return</span>
            
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">predict</span><span class="hljs-params">(<span class="hljs-keyword">self</span>, v)</span></span>:
        cnt = np.zeros(n_class)
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-keyword">self</span>.n_estimators):
            cnt[<span class="hljs-keyword">self</span>.dtrees[i].predict(v)] += <span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> np.argmax(cnt)
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calc_ac</span><span class="hljs-params">(<span class="hljs-keyword">self</span>, testd)</span></span>:
        total = <span class="hljs-number">0</span>.<span class="hljs-number">0</span>
        succ = <span class="hljs-number">0</span>.<span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-symbol">testd:</span>
            succ += int(<span class="hljs-keyword">self</span>.predict(d) == d[LAB])
            total += <span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> succ/total  
</code></pre></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Intro-to-AI-lab-4---Random-Forest-Implementation-and-Discussion" title="Intro to AI lab 4 - Random Forest, Implementation and Discussion">Intro to AI lab 4 - Random Forest, Implementation and Discussion</a><ul class="nav">
<li><a href="#Information" title="Information">Information</a></li>
<li><a href="#Task-description" title="Task description">Task description</a></li>
<li><a href="#Description-of-random-forest" title="Description of random forest">Description of random forest</a><ul class="nav">
<li><a href="#Decision-Tree" title="Decision Tree">Decision Tree</a></li>
<li><a href="#Random-Forest" title="Random Forest">Random Forest</a></li>
</ul>
</li>
<li><a href="#Implementation" title="Implementation">Implementation</a><ul class="nav">
<li><a href="#Node" title="Node">Node</a></li>
<li><a href="#Cart" title="Cart">Cart</a></li>
<li><a href="#Randon-Forest" title="Randon Forest">Randon Forest</a></li>
</ul>
</li>
<li class=""><a href="#Experimental-Results-and-Discussion" title="Experimental Results and Discussion">Experimental Results and Discussion</a><ul class="nav">
<li class=""><a href="#Setting-of-experients" title="Setting of experients">Setting of experients</a></li>
<li><a href="#Choice-of-Order-of-Experiments" title="Choice of Order of Experiments">Choice of Order of Experiments</a></li>
<li><a href="#Training-Set-Size" title="Training Set Size">Training Set Size</a></li>
<li><a href="#Number-of-trees-and-F1-score" title="Number of trees and F1 score">Number of trees and F1 score</a></li>
<li><a href="#Criterion-for-spliting" title="Criterion for spliting">Criterion for spliting</a></li>
<li><a href="#Early-Cut---Depth-of-TreesSplit-Constraint-on-number-of-dataMin-Impurity-Gain" title="Early Cut - Depth of Trees/Split Constraint on number of data/Min Impurity Gain">Early Cut - Depth of Trees/Split Constraint on number of data/Min Impurity Gain</a></li>
</ul>
</li>
<li><a href="#Conclusion-and-Future-investigations" title="Conclusion and Future investigations">Conclusion and Future investigations</a></li>
<li><a href="#Reference" title="Reference">Reference</a></li>
<li><a href="#Appendix-A---Python-Implementation-of-Random-Forest" title="Appendix A - Python Implementation of Random Forest">Appendix A - Python Implementation of Random Forest</a><ul class="nav">
<li><a href="#RandomForestpy" title="RandomForest.py">RandomForest.py</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#Intro-to-AI-lab-4---Random-Forest-Implementation-and-Discussion" title="Intro to AI lab 4 - Random Forest, Implementation and Discussion">Intro to AI lab 4 - Random Forest, Implementation and Discussion</a><ul class="nav">
<li><a href="#Information" title="Information">Information</a></li>
<li><a href="#Task-description" title="Task description">Task description</a></li>
<li><a href="#Description-of-random-forest" title="Description of random forest">Description of random forest</a><ul class="nav">
<li><a href="#Decision-Tree" title="Decision Tree">Decision Tree</a></li>
<li><a href="#Random-Forest" title="Random Forest">Random Forest</a></li>
</ul>
</li>
<li><a href="#Implementation" title="Implementation">Implementation</a><ul class="nav">
<li><a href="#Node" title="Node">Node</a></li>
<li><a href="#Cart" title="Cart">Cart</a></li>
<li><a href="#Randon-Forest" title="Randon Forest">Randon Forest</a></li>
</ul>
</li>
<li class=""><a href="#Experimental-Results-and-Discussion" title="Experimental Results and Discussion">Experimental Results and Discussion</a><ul class="nav">
<li class=""><a href="#Setting-of-experients" title="Setting of experients">Setting of experients</a></li>
<li><a href="#Choice-of-Order-of-Experiments" title="Choice of Order of Experiments">Choice of Order of Experiments</a></li>
<li><a href="#Training-Set-Size" title="Training Set Size">Training Set Size</a></li>
<li><a href="#Number-of-trees-and-F1-score" title="Number of trees and F1 score">Number of trees and F1 score</a></li>
<li><a href="#Criterion-for-spliting" title="Criterion for spliting">Criterion for spliting</a></li>
<li><a href="#Early-Cut---Depth-of-TreesSplit-Constraint-on-number-of-dataMin-Impurity-Gain" title="Early Cut - Depth of Trees/Split Constraint on number of data/Min Impurity Gain">Early Cut - Depth of Trees/Split Constraint on number of data/Min Impurity Gain</a></li>
</ul>
</li>
<li><a href="#Conclusion-and-Future-investigations" title="Conclusion and Future investigations">Conclusion and Future investigations</a></li>
<li><a href="#Reference" title="Reference">Reference</a></li>
<li><a href="#Appendix-A---Python-Implementation-of-Random-Forest" title="Appendix A - Python Implementation of Random Forest">Appendix A - Python Implementation of Random Forest</a><ul class="nav">
<li><a href="#RandomForestpy" title="RandomForest.py">RandomForest.py</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
